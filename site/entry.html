<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Entry</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://unpkg.com/molstar/build/viewer/molstar.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/molstar/build/viewer/molstar.css" />
</head>
<body>
  <a href="index.html">‚Üê Back</a>
  <h1 id="title"></h1>
  <div id="viewer" style="width:100%; height:600px; border:1px solid #ddd;"></div>
  <h2>Sequence (FASTA)</h2>
  <pre id="fasta">Loading...</pre>

  <script>
    function getParam(name){ return new URL(location.href).searchParams.get(name); }
    async function load(){
      const uid = getParam('uid');
      const catalog = await fetch('../data/entries.json').then(r=>r.json());
      const entry = catalog.entries.find(e => e.uniprot_id === uid);
      if(!entry){ document.body.innerHTML = "Not found"; return; }
      document.getElementById('title').textContent = uid;

      fetch(entry.files.sequence_fasta)
        .then(r=>r.text())
        .then(t => { document.getElementById('fasta').textContent = t; })
        .catch(()=>{ document.getElementById('fasta').textContent = 'FASTA not available.'; });

      const viewer = new molstar.Viewer('viewer', { layoutIsExpanded:false, layoutShowControls:true });
      await viewer.loadStructureFromUrl(entry.files.structure_cif, 'mmcif');
      viewer.resetCamera();
    }
    load();
  </script>
</body>
</html>
